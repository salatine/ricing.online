<!doctype html>
<html>

<head>
    <title>awesome!</title>

    <script src="/build/v86/libv86.js"> </script>
    <script src="/build/index.js"> </script>
    <script>
        "use strict";
        window.onload = function () {
            window.emulator = new V86Starter({
                wasm_path: "/build/v86/v86.wasm",
                memory_size: 512 * 1024 * 1024,
                vga_memory_size: 8 * 1024 * 1024,
                screen_container: document.getElementById("screen_container"),
                initial_state: { url: "/build/images/debian-state-base.bin.zst" },
                filesystem: { baseurl: "/build/images/debian-9p-rootfs-flat/" },
                autostart: true,
            });

            window.emulator.add_listener("serial0-output-char", function (char) {
                if(char === "\r") {
                    return;
                }

                document.getElementById("serial").value += char;
            });
        };
    </script>
</head>

<body>
    <select id="terminal">
        <option value="kitty">kitty</option>
        <option value="alacritty">Alacritty</option>
        <option value="terminator">Terminator</option>
        <option value="gnome-terminal">GNOME Terminal</option>
        <option value="konsole">Konsole</option>
        <option value="xterm">xterm</option>
        <option value="st">st</option>
    </select>
    <input type="file" id="file" name="file" value="change bg"></input>
    <input type="button"  value="teste restart" id="updatePreview"></input>
    <div id="screen_container">
        <div style="white-space: pre; font: 14px monospace; line-height: 14px"></div>
        <canvas style="display: none"></canvas>
    </div>

    <textarea spellcheck="false" cols="40" rows="12" id="serial">
    </textarea>
</body>

</html>